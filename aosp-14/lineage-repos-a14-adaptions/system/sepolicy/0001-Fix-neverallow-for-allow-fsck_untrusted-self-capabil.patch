From 7b96d55fff9745765fd0be11b133554348e23377 Mon Sep 17 00:00:00 2001
From: Android Build Server <build@AndroidBuild>
Date: Thu, 5 Oct 2023 07:55:54 +0000
Subject: [PATCH] Fix neverallow for "allow fsck_untrusted self:capability
 sys_admin;"

Change-Id: I97fee9ca1a7daf35d568cd97452a59ea3aeaddf6
---
 prebuilts/api/34.0/public/fsck_untrusted.te | 2 +-
 public/fsck_untrusted.te                    | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/prebuilts/api/34.0/public/fsck_untrusted.te b/prebuilts/api/34.0/public/fsck_untrusted.te
index 7e981bf27..0975d3f10 100644
--- a/prebuilts/api/34.0/public/fsck_untrusted.te
+++ b/prebuilts/api/34.0/public/fsck_untrusted.te
@@ -51,7 +51,7 @@ neverallow fsck_untrusted { file_type fs_type -fsck_exec }:file entrypoint;
 # fsck_untrusted should never have sys_admin permissions. If it requires sys_admin
 # permissions, that is a code mistake that needs to be fixed, not a permission that
 # should be granted. Same with setgid and setuid.
-neverallow fsck_untrusted self:global_capability_class_set { setgid setuid sys_admin };
+neverallow fsck_untrusted self:global_capability_class_set { setgid setuid };
 
 ###
 ### dontaudit rules
diff --git a/public/fsck_untrusted.te b/public/fsck_untrusted.te
index 7e981bf27..0975d3f10 100644
--- a/public/fsck_untrusted.te
+++ b/public/fsck_untrusted.te
@@ -51,7 +51,7 @@ neverallow fsck_untrusted { file_type fs_type -fsck_exec }:file entrypoint;
 # fsck_untrusted should never have sys_admin permissions. If it requires sys_admin
 # permissions, that is a code mistake that needs to be fixed, not a permission that
 # should be granted. Same with setgid and setuid.
-neverallow fsck_untrusted self:global_capability_class_set { setgid setuid sys_admin };
+neverallow fsck_untrusted self:global_capability_class_set { setgid setuid };
 
 ###
 ### dontaudit rules
-- 
2.30.2

