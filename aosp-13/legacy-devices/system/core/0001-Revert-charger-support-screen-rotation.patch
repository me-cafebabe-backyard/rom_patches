From 2e339d876f78b7539e0482f009ca097be5083866 Mon Sep 17 00:00:00 2001
From: me-cafebabe <me_cafebabe@hotmail.com>
Date: Wed, 21 Sep 2022 13:46:31 +0000
Subject: [PATCH 1/3] Revert "charger: support screen rotation"

This reverts commit 56540a0509d60f7b419a779b74ad31178b9f1fbc.

Change-Id: Ib7a57aa987c1c0464d3dd0c2f458f668b5a551dc
---
 healthd/healthd_draw.cpp         | 9 ---------
 healthd/healthd_draw.h           | 3 ---
 healthd/healthd_mode_charger.cpp | 1 -
 3 files changed, 13 deletions(-)

diff --git a/healthd/healthd_draw.cpp b/healthd/healthd_draw.cpp
index 3e73fcd08..0e6fd2783 100644
--- a/healthd/healthd_draw.cpp
+++ b/healthd/healthd_draw.cpp
@@ -99,15 +99,6 @@ void HealthdDraw::blank_screen(bool blank, int drm) {
     gr_fb_blank(blank, drm);
 }
 
-/* support screen rotation for foldable phone */
-void HealthdDraw::rotate_screen(int drm) {
-    if (!graphics_available) return;
-    if (drm == 0)
-        gr_rotate(GRRotation::RIGHT /* landscape mode */);
-    else
-        gr_rotate(GRRotation::NONE /* Portrait mode */);
-}
-
 void HealthdDraw::clear_screen(void) {
     if (!graphics_available) return;
     gr_color(0, 0, 0, 255);
diff --git a/healthd/healthd_draw.h b/healthd/healthd_draw.h
index 3d4abbdda..0d7ac7ad0 100644
--- a/healthd/healthd_draw.h
+++ b/healthd/healthd_draw.h
@@ -35,9 +35,6 @@ class HealthdDraw {
   // Blanks screen if true, unblanks if false.
   virtual void blank_screen(bool blank, int drm);
 
-  // Rotate screen.
-  virtual void rotate_screen(int drm);
-
   static std::unique_ptr<HealthdDraw> Create(animation *anim);
 
  protected:
diff --git a/healthd/healthd_mode_charger.cpp b/healthd/healthd_mode_charger.cpp
index 9fe85d40d..012e33ba1 100644
--- a/healthd/healthd_mode_charger.cpp
+++ b/healthd/healthd_mode_charger.cpp
@@ -352,7 +352,6 @@ void Charger::UpdateScreenState(int64_t now) {
     if (screen_switch_ == SCREEN_SWITCH_ENABLE) {
         healthd_draw_->blank_screen(true, 0 /* drm */);
         healthd_draw_->blank_screen(true, 1 /* drm */);
-        healthd_draw_->rotate_screen(static_cast<int>(drm_));
         screen_blanked_ = true;
         screen_switch_ = SCREEN_SWITCH_DISABLE;
     }
-- 
2.30.2

